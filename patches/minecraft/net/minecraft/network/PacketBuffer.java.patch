--- ../src-base/minecraft/net/minecraft/network/PacketBuffer.java
+++ ../src-work/minecraft/net/minecraft/network/PacketBuffer.java
@@ -334,10 +334,7 @@
             this.writeShort(p_150788_1_.func_77960_j());
             NBTTagCompound nbttagcompound = null;
 
-            if (p_150788_1_.func_77973_b().func_77645_m() || p_150788_1_.func_77973_b().func_77651_p())
-            {
-                nbttagcompound = p_150788_1_.func_77978_p();
-            }
+            nbttagcompound = p_150788_1_.getShareTag();
 
             this.func_150786_a(nbttagcompound);
         }
@@ -358,7 +355,7 @@
             int j = this.readByte();
             int k = this.readShort();
             ItemStack itemstack = new ItemStack(Item.func_150899_d(i), j, k);
-            itemstack.func_77982_d(this.func_150793_b());
+            itemstack.readShareTag(this.func_150793_b());
             return itemstack;
         }
     }
